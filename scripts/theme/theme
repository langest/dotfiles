#!/usr/bin/env bash
set -euo pipefail

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cmd_name="$(basename "$0")"

usage() {
  cat <<EOF
Usage: $cmd_name <command> [args]

Commands:
  list
  set <theme-name>
  current
  refresh
  install <git-repo-url>
  update
  remove <theme-name>
  sync
  btop
  foot
  nvim
  wofi
  wallpaper
  swaylock
  lock
EOF
}

cmd="${1:-}"
if [[ $# -gt 0 ]]; then
  shift
fi

case "$cmd" in
  list) "$script_dir/list.sh" "$@" ;;
  set)
    if [[ $# -eq 0 ]]; then
      echo "Usage: $cmd_name set <theme-name>" >&2
      exit 1
    fi
    "$script_dir/set.sh" "$@"
    ;;
  current) "$script_dir/current.sh" "$@" ;;
  refresh) "$script_dir/refresh.sh" "$@" ;;
  install)
    if [[ $# -eq 0 ]]; then
      echo "Usage: $cmd_name install <git-repo-url>" >&2
      exit 1
    fi
    "$script_dir/install.sh" "$@"
    ;;
  update) "$script_dir/update.sh" "$@" ;;
  remove)
    if [[ $# -eq 0 ]]; then
      echo "Usage: $cmd_name remove <theme-name>" >&2
      exit 1
    fi
    "$script_dir/remove.sh" "$@"
    ;;
  sync) "$script_dir/sync_builtin.sh" "$@" ;;
  btop) "$script_dir/setters/set_btop.sh" "$@" ;;
  foot) "$script_dir/setters/set_foot.sh" "$@" ;;
  nvim) "$script_dir/setters/set_nvim.sh" "$@" ;;
  wofi) "$script_dir/setters/set_wofi.sh" "$@" ;;
  wallpaper) "$script_dir/setters/set_wallpaper.sh" "$@" ;;
  swaylock) "$script_dir/setters/set_swaylock.sh" "$@" ;;
  lock) "$script_dir/lock.sh" "$@" ;;
  ""|-h|--help|help) usage ;;
  *)
    echo "Unknown command: $cmd" >&2
    usage
    exit 1
    ;;
esac
